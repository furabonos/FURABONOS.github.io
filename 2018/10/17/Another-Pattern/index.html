<!DOCTYPE html>
<html lang="kor">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="furabono blog"/>
    

    <!--Author-->
    
        <meta name="author" content="FURABONO"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Another Pattern"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="furabono blog"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="study blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="http://furabonos.github.iohttp://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="http://furabonos.github.iohttp://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg"/>
    

    <!-- Title -->
    
    <title>Another Pattern - study blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    


    <!-- favicon -->
    

</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Configurable Title</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/klugjo/hexo-theme-clean-blog">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('http://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Another Pattern</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2018-10-17
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/swift/">#swift</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>저번 포스팅에선 가장 대중적인 패턴이라 볼수있는 MVC패턴에 대해 포스팅했다. 이번 포스팅에선 ios개발을 하다보면 자주볼수 있는 패턴인 Delegation, Notification, KVO에 대해 작성한다. 위의 세가지 패턴은 대부분 View와 Controller간의 소통이 필요할때 사용한다. 사용하는 방법이 조금씩 차이가 날뿐 기본 매커니즘은 동일하다. 어떤 이벤트가 A에서 일어나면 B에 알려주어 적절한 조취를 취한다. 이런 경우 언제 어디서 어떤 패턴을 사용할까?</p>
<h3 id="Delegation"><a href="#Delegation" class="headerlink" title="Delegation"></a>Delegation</h3><p>Delegate는 보통 프로토콜을 정의하여 사용한다. 프로토콜이란 일종의 기능명세서 같은것으로 Delegate로 지정된 객체가 해야 하는 메소드들의 원형을 적어놓는다. Delegate 역할을 하려는 객체는 이 프로토콜을 따르며 원형만 있던 메소드들을 구현한다. 이렇게 세팅후 이전 객체는 어떤 이벤트가 일어났을시 Delegate로 지정한 객체에 알려줄수있다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1) 프로토콜 선언</span></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SomeDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">someFunction</span><span class="params">(someProperty: Int)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 2) 순환참조를 막기위해 weak으로 delegate선언</span></span><br><span class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> delegate: <span class="type">SomeDelegate</span>?</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">SomeTapped</span><span class="params">(num: Int)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 3) 이벤트가 일어날시 delegate가 동작하게 함</span></span><br><span class="line">        delegate?.someFunction(someProperty: num)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4) Delegate 프로토콜을 따르도록 함</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeController</span>: <span class="title">SomeDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> view: <span class="type">SomeView</span>?</span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        view = <span class="type">SomeView</span>?</span><br><span class="line">        <span class="comment">// 6) delegate를 자기자신으로 설정</span></span><br><span class="line">        view?.delegate = <span class="keyword">self</span></span><br><span class="line">        someFunction(someProperty: <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5) Delegate 프로토콜에 적힌 메소드 구현</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">someFunction</span><span class="params">(someProperty: Int)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(someProperty)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> someController = <span class="type">SomeController</span>()</span><br><span class="line"><span class="comment">// print 0</span></span><br></pre></td></tr></table></figure></p>
<h4 id="장점"><a href="#장점" class="headerlink" title="장점"></a>장점</h4><ul>
<li>매우 엄격한 Syntax로 인해 프로토콜에 필요한 메소드들이 명확하게 명시됨</li>
<li>컴파일 시 경고나 에러가 떠서 프로토콜의 구현되지 않은 메소드를 알려줌</li>
<li>로직의 흐름을 따라가기 쉬움</li>
<li>프로토콜 메소드로 알려주는 것뿐만이 아니라 정보를 받을수 있음</li>
<li>커뮤니케이션 과정을 유지하고 모니터링 하는 제 3의 객체(ex: Notification)가 필요없음</li>
<li>프로토콜이 컨트롤러의 범위안에서 정의됨</li>
</ul>
<h4 id="단점"><a href="#단점" class="headerlink" title="단점"></a>단점</h4><ul>
<li>많은 줄의 코드가 필요</li>
<li>delegate설정에 nil이 들어가지 않게끔 주의가 필요</li>
<li>많은 객체들에게 이벤트를 알려주는것이 어렵고 비효율적</li>
</ul>
<h3 id="Notification"><a href="#Notification" class="headerlink" title="Notification"></a>Notification</h3><p>Notification Center라는 싱글턴 객체를 통해서 이벤트들의 발생 여부를 옵저버를 등록한 객체들에게 Notification을 post하는 방식으로 사용한다. Notification name이라는 key값을 통해 보내고 받을수있다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1) Notification을 보내는 ViewController</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">var</span> sendNotificationButton: <span class="type">UIButton</span>!</span><br><span class="line"></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">sendNotificationTapped</span><span class="params">(<span class="number">_</span> sender: UIButton)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> backgroundColor = view.backgroundColor <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">        <span class="comment">// Notification에 object와 dictionary 형태의 userInfo를 같이 실어서 보낸다</span></span><br><span class="line">        <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.post(name: <span class="type">Notification</span>.<span class="type">Name</span>(<span class="string">"notification"</span>), object: sendNotification, userInfo: [<span class="string">"backgroundColor"</span>: backgroundColor])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2) Notification을 받는 ViewController</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 옵저버를 추가해 구독이 가능하게끔 함</span></span><br><span class="line">        <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(<span class="keyword">self</span>, selector: #selector(notificationReceived(notification:)), name: <span class="type">Notification</span>.<span class="type">Name</span>(<span class="string">"notification"</span>), object: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// iOS 9 이상이 아닐 경우에는 removeObserver를 해줘야 함</span></span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="type">NotificationCetner</span>.<span class="keyword">default</span>.removeObserver(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">notificationReceived</span><span class="params">(notification: Notification)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Notification에 담겨진 object와 userInfo를 얻어 처리 가능</span></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> notificationObject = notification.object <span class="keyword">as</span>? <span class="type">UIButton</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">        <span class="built_in">print</span>(notificationObject.titleLabel?.text ?? <span class="string">"Text is Empty"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> notificationUserInfo = notification.userInfo <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">UIColor</span>],</span><br><span class="line">            <span class="keyword">let</span> postViewBackgroundColor = notificationUserInfo[<span class="string">"backgroundColor"</span>] <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">        <span class="built_in">print</span>(postViewBackgroundColor)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="장점-1"><a href="#장점-1" class="headerlink" title="장점"></a>장점</h4><ul>
<li>많은줄의 코드가 필요없이 쉽게 구현가능</li>
<li>다수의 객체들에게 동시에 이벤트의 발생을 알려줄수있음</li>
<li>Notification과 관련된 정보를 Any?타입의 object, [AnyHashble: Any]? 타입의 userInfo로 전달할 수 있음</li>
</ul>
<h4 id="단점-1"><a href="#단점-1" class="headerlink" title="단점"></a>단점</h4><ul>
<li>key값으로 Notification의 이름과 userInfo를 서로 맞추기 때문에 컴파일시 구독이 잘되고 있는지, 올바르게 userInfo의 value를 받아오는지 체크가 불가능함</li>
<li>추적이 쉽지 않을 수 있음</li>
<li>Notificaion post이후 정보를 받을 수 없음</li>
</ul>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/klugjo/hexo-theme-clean-blog" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2018 FURABONO<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>