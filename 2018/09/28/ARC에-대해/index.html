<!DOCTYPE html>
<html lang="kor">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="furabono blog"/>
    

    <!--Author-->
    
        <meta name="author" content="FURABONO"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="ARC에 대해"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="furabono blog"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="study blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="http://furabonos.github.iohttp://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="http://furabonos.github.iohttp://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg"/>
    

    <!-- Title -->
    
    <title>ARC에 대해 - study blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    


    <!-- favicon -->
    

</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Configurable Title</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/klugjo/hexo-theme-clean-blog">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('http://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>ARC에 대해</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2018-09-28
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/swift/">#swift</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h4 id="About-ARC"><a href="#About-ARC" class="headerlink" title="About ARC?"></a>About ARC?</h4><p>ARC(Auto Reference Counting)은 자동으로 메모리 관리를 해주는 것이다. 컴파일러가 개발자를 대신하여 메모리 관리 코드를 적절한 곳에 자동으로 삽입 해준다. 그래서 개발자가 특별하게 할 일은 없지만 개념을 알고있어야 해결할수 있는 문제가 있기 때문에 잘 알아야 한다.<br><img src="https://i.imgur.com/Cm3c86L.png" alt="Imgur"></p>
<p>메모리 관리는 가상 메모리 영역 중 Heap 영역과 관련이 있다. Heap 영역은 Class, Closure 같은 참조형 자료들이 머무는 공간이며 개발자가 동적으로 할당하는 메모리 공간이다. 이 Heap 영역의 Reference 자료들이 프로그램 상에서 얼마나 참조되고 있는지 숫자를 세서(Reference Counting) 메모리에 할당 및 제거 과정을 자동으로 관리하는게 ARC다. </p>
<h4 id="History"><a href="#History" class="headerlink" title="History"></a>History</h4><p>ARC가 있기전엔 메모리 관리를 어떻게 했을지 알아보자.</p>
<ol>
<li>GC(Garbage Collection)</li>
</ol>
<ul>
<li>정기적으로 Garbage Collector가 동작하여 더이상 사용되지 않는 메모리를 반환하는 방식</li>
<li>OS X에서만 지원했으나, 버전 10.8(Mountain Lion)부터 사용되지 않음</li>
</ul>
<ol start="2">
<li>MRR(Manual Retain-Release) / MRC(Manual Reference Counting)</li>
</ol>
<ul>
<li>RC(Reference Counting)을 통해 메모리를 수동적으로 관리하는 방식</li>
<li>retain / release / autorelease 등의 메모리 관리 코드를 직접 호출</li>
<li>개발자가 명시적으로 RC를 증가시키고 감소시키는 작업 수행</li>
</ul>
<h5 id="About-MRR"><a href="#About-MRR" class="headerlink" title="About MRR"></a>About MRR</h5><ul>
<li>MRR을 이해하려면 RC에 대한 이해가 필요하다. (Reference Counting / Retain Count / Reference Count)</li>
<li>Objective-C 에서는 ARC 해제 가능</li>
</ul>
<p><img src="https://i.imgur.com/KI2x51P.png" alt="Imgur"></p>
<h5 id="Reference-Counting"><a href="#Reference-Counting" class="headerlink" title="Reference Counting"></a>Reference Counting</h5><p><img src="https://i.imgur.com/rAX96hi.png" alt="Imgur"><br><img src="https://i.imgur.com/Qhzzu7S.png" alt="Imgur"></p>
<h3 id="Reference-와-Heap"><a href="#Reference-와-Heap" class="headerlink" title="Reference 와 Heap"></a>Reference 와 Heap</h3><p>ARC에서 말하는 ‘참조’란, 따로 사본을 만들지 않고 원본을 참조한다는 의미다.<br>마치 책 한권을 두고 여러사람이 같이보는 형태다. 책을 여러권 사면 돈과 공간을 낭비하게 되는데, 누군가 책을 훼손한다면 책을 보는 모두에게 영향을 끼치게 된다.<br>프로그래밍 또한 비슷한 원리다. 하나의 원본을 두고 여럿이 참조를 한다. 참조문제는 보통 변수가 함수의 인자로 사용될때 생긴다. 함수는 보통 인자로 들어오는 값을 변형하여 값을 도출하는데, 인자를 원본 그대로 받아 사용하면 원본이 훼손되는 경우가 발생한다. 이러한 경우엔 사본을 만들어서 사용하는게 더 효율적이다. 반대로 하나의 원본을 계속 사용해야 되는 경우는 위의 예시처럼 원본을 사용하는게 효율적일 때가 있다. </p>
<h4 id="Reference-변수-프로퍼티에-대입하는-경우"><a href="#Reference-변수-프로퍼티에-대입하는-경우" class="headerlink" title="Reference - 변수/프로퍼티에 대입하는 경우"></a>Reference - 변수/프로퍼티에 대입하는 경우</h4><p>밑의 예시는 Class의 인스턴스를 여러 변수에 대입시켜 참조하는 경우이다.<br>이처럼 메모리에 계속 잡아두는 참조는 참조 자료형이 다른 변수, 프로퍼티에 대입되거나 클로저, 중첩함수일때 발생한다. 인스턴스가 메모리에서 해제되었는지 확인할땐 deinit을 사용한다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="type">Person</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(name)</span> is being initialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(name)</span> is being deinitialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reference1: <span class="type">Person</span>?</span><br><span class="line"><span class="keyword">var</span> reference2: <span class="type">Person</span>?</span><br><span class="line"><span class="keyword">var</span> reference3: <span class="type">Person</span>?</span><br><span class="line"></span><br><span class="line">reference1 = <span class="type">Person</span>(name: <span class="string">"FURABONO"</span>)</span><br><span class="line"><span class="comment">//print "FURABONO is being initialized" -- reference count 1</span></span><br><span class="line">reference2 = reference1 <span class="comment">// -- reference count 2</span></span><br><span class="line">reference3 = reference1 <span class="comment">// -- reference count 3</span></span><br><span class="line"></span><br><span class="line">reference1 = <span class="literal">nil</span> <span class="comment">// -- reference count 2 (아직 자신을 참조하는 변수가 있어서 메모리에서 해제되지 않음.)</span></span><br><span class="line">reference2 = <span class="literal">nil</span> <span class="comment">// -- reference count 1</span></span><br><span class="line">reference3 = <span class="literal">nil</span> <span class="comment">// -- reference count 0</span></span><br><span class="line"><span class="comment">//이제 reference1이 메모리에서 제거</span></span><br><span class="line"><span class="comment">//print "FURABONO is being deinitialized"</span></span><br></pre></td></tr></table></figure></p>
<h4 id="Reference-함수의-인자에-인스턴스를-대입하는-경우"><a href="#Reference-함수의-인자에-인스턴스를-대입하는-경우" class="headerlink" title="Reference - 함수의 인자에 인스턴스를 대입하는 경우"></a>Reference - 함수의 인자에 인스턴스를 대입하는 경우</h4><p>밑의 예시는 클래스의 인스턴스가 함수의 인자로 대입되면서 참조가 발생하는 예시다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> myClass &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Class</span> anotherClass &#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">anotherMethod</span><span class="params">(param: myClass)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(param === newInstance)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newInstance = myClass() <span class="comment">// myClass의 인스턴스 객체생성하여 newinstance에 대입.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> anotherInstance = anotherClass()</span><br><span class="line"></span><br><span class="line">anotherInstance.anotherMethod(param: newInstance)</span><br><span class="line"><span class="comment">// 또다른 객체인 anotherInstance 생성.</span></span><br><span class="line"><span class="comment">// 새 객체(anotherInstance)의 메서드에 newInstance를 대입.</span></span><br><span class="line"><span class="comment">// class는 reference 자료형이기 때문에 인자로 들어갈 경우 참조카운트 + 1</span></span><br><span class="line"><span class="comment">// 그리고 함수실행 종료후 해제되기 때문에 카운트는 다시 0이 됨.</span></span><br><span class="line"><span class="comment">// 인자로 대입된 객체와 newInstance 객체는 참조하는 원본이 같으므로 true가 됨.</span></span><br></pre></td></tr></table></figure></p>
<p>위의 예시처럼 함수의 인자로 인스턴스가 들어올 경우 함수가 종료되면 참조가 바로 소멸되며 메모리에서 해제가 된다. 즉, 위에서 newInstance를 변수로 선언하고 optional 자료형으로 변경한뒤 anotherMethod 수행후에 nil로 만들면 바로 deinitialized 되어서 사라진다.</p>
<h4 id="단일원본-X"><a href="#단일원본-X" class="headerlink" title="단일원본 X"></a>단일원본 X</h4><p>위의 예시들에서 헷갈리지 말아야 할 포인트는, ()로 새 객체를 선언할때 이는 기존의 객체와는 다른 존재라는 점이다. 한 클래스의 객체 여러개가 전부 하나의 원본을 공유하는게 아니라는 뜻이다. 두번째 예시처럼 객체가 변수에 대입되거나, 함수의 인자가 될때 원본을 참조하는 것이다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> firstInstance = myClass()</span><br><span class="line"><span class="keyword">let</span> secondInstance = myClass()</span><br><span class="line"><span class="keyword">let</span> thirdInstance = myClass()</span><br><span class="line"></span><br><span class="line">firstInstance === secondInstance <span class="comment">// false</span></span><br><span class="line"><span class="keyword">let</span> lastInstance = firstInstance</span><br><span class="line">lastInstance === firstInstance <span class="comment">// true</span></span><br></pre></td></tr></table></figure></p>
<h4 id="Pointer"><a href="#Pointer" class="headerlink" title="Pointer?"></a>Pointer?</h4><p>필요할때마다 사본을 만들면 메모리가 낭비될수가 있다. 그래서 ‘너가 만든 사본데이터는 이미 메모리 어디에 저장되어 있으니 그걸 가져다 쓰자’ 라고 말하고 사용하는것이 메모리관리가 좀더 효율적이다. 즉 앞으로 계속쓰일 데이터는 하나만 만들고, 누군가 데이터를 사용할때 데이터를 생성하지 않고 먼저 만든 데이터의 주소를 알려주는 것이다. 이렇게 주소값을 저장한 것이 바로 Pointer 변수다.</p>
<h3 id="Strong-Reference-Cycle"><a href="#Strong-Reference-Cycle" class="headerlink" title="Strong Reference Cycle"></a>Strong Reference Cycle</h3><p>swift에서 발생하는 reference는 기본적으로 strong reference로 처리된다. 즉 let myClass = MyClass() 처럼 객체를 하나 생성했을시 해당 인스턴스의 카운트가 0이 될때까진 메모리에 강하게 참조한다.<br>Strong Reference Cycle은 reference끼리 서로를 참조할때 나타난다. 특히 서로다른 두 class의 프로퍼티끼리 상대방의 인스턴스를 참조하는 경우가 대표적이다. 이 인스턴스들은 자신을 참조한 변수를 nil 처리를 해도 메모리에서 해제되지가 않아서 메모리 낭비가 발생한다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> apartment: <span class="type">Apartment</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(name)</span> is being deinitialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Apartment</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> unit: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> tenant: <span class="type">Person</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(unit: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.unit = unit</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Apartment <span class="subst">\(unit)</span> is being deinitialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> john: <span class="type">Person</span>? = <span class="type">Person</span>(name: <span class="string">"john Appleseed"</span>)</span><br><span class="line"><span class="keyword">var</span> unit4A: <span class="type">Apartment</span>? = <span class="type">Apartment</span>(unit: <span class="string">"4A"</span>)</span><br><span class="line"></span><br><span class="line">john!.apartment = unit4A</span><br><span class="line">unit4A!.tenant = john</span><br><span class="line"><span class="comment">// 두 프로퍼티 간에 강한 상호 참조 발생</span></span><br><span class="line"></span><br><span class="line">john = <span class="literal">nil</span></span><br><span class="line">unit4A = <span class="literal">nil</span></span><br><span class="line"><span class="comment">//두 프로퍼티 모두 nil로 해도 강한 상호 참조가 발생하여 메모리에서 해제되지 않음.</span></span><br><span class="line"><span class="comment">//deinit은 호출되지 않음.</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://i.imgur.com/8lMmuXM.png" alt="Imgur"></p>
<h4 id="weak-var"><a href="#weak-var" class="headerlink" title="weak var"></a>weak var</h4><p>class 프로퍼티를 weak var로 선언하면 강한 순환 참조를 예방할수있다. weak 키워드는 상호 참조가 발생하는 프로퍼티 모두에 선언할 필요없이 한쪽에만 선언하면 된다. 주로 개념상 상대보다 프로그램에 오래 머무르는 class에서 선언해준다. 이는 내안에서 상대를 nil 처리를 해주는것이라서 내가 상대보다 오래 사는 경우다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> apartment: <span class="type">Apartment</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(name)</span> is being deinitialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Apartment</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> unit: <span class="type">String</span></span><br><span class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> tenant: <span class="type">Person</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(unit: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.unit = unit</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Apartment <span class="subst">\(unit)</span> is being deinitialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> john: <span class="type">Person</span>? = <span class="type">Person</span>(name: <span class="string">"john Appleseed"</span>)</span><br><span class="line"><span class="keyword">var</span> unit4A: <span class="type">Apartment</span>? = <span class="type">Apartment</span>(unit: <span class="string">"4A"</span>)</span><br><span class="line"></span><br><span class="line">john!.apartment = unit4A</span><br><span class="line">unit4A!.tenant = john</span><br><span class="line"><span class="comment">// 두 프로퍼티 간에 강한 상호 참조 발생</span></span><br><span class="line"></span><br><span class="line">john = <span class="literal">nil</span></span><br><span class="line"><span class="comment">// "john Appleseed is being deinitialized"</span></span><br><span class="line">unit4A = <span class="literal">nil</span></span><br><span class="line"><span class="comment">// "Apartment 4A is being deinitialized"</span></span><br></pre></td></tr></table></figure></p>
<p>이때 weak을 선언하려면 프로퍼티의 자료형은 optional이 되어야 한다. 상대를 놓아주는것이 해당 프로퍼티값을 nil로 만드는건데 이렇게 nil을 주려면 optional이어야 하기 때문이다. </p>
<h4 id="unowned"><a href="#unowned" class="headerlink" title="unowned"></a>unowned</h4><p>unowned로 선언된 변수는 자신만큼은 reference counting 하지 말라고 선언을 하는것이다. 카운팅을 하지 않으니 당연히 순환참조가 생길 이유도 없다.<br>다만 unowned처럼 카운팅을 하지 않을때 참조하는 인스턴스가 nil이 되면 원본없는 참조가 생길 가능성이 생긴다. 그래서 unowned로 선언되는 변수는 nil이 될수없고 optional이 될수 없다. 이런 점에 따라 unowned는 weak과 달리 수명이 짧은쪽에서 선언한다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> card: <span class="type">CreditCard</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(name)</span> is being deinitialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreditCard</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> number: <span class="type">UInt64</span></span><br><span class="line">    <span class="keyword">unowned</span> <span class="keyword">let</span> customer: <span class="type">Customer</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(number: <span class="type">UInt64</span>, customer: <span class="type">Customer</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.number = number</span><br><span class="line">        <span class="keyword">self</span>.customer = customer</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"card #<span class="subst">\(number)</span> is being deinitialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> john: <span class="type">Customer</span>? = <span class="type">Customer</span>(name: <span class="string">"john Appleseed"</span>)</span><br><span class="line">john!.card = <span class="type">CreditCard</span>(number: <span class="number">1234_5678_9012_3456</span>, customer: john!)</span><br><span class="line"></span><br><span class="line">john = <span class="literal">nil</span></span><br><span class="line"><span class="comment">// "john Appleseed is being deinitialized"</span></span><br><span class="line"><span class="comment">// "card #1234_5678_9012_3456 is being deinitialized"</span></span><br><span class="line">`</span><br></pre></td></tr></table></figure></p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/klugjo/hexo-theme-clean-blog" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2018 FURABONO<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>